(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[746],{17042:function(e,t,a){Promise.resolve().then(a.bind(a,93845))},93845:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(57437),r=a(2265),n=a(47625),d=a(77031),o=a(56940),l=a(97059),i=a(62994),c=a(8147),u=a(22190),m=a(31699),x=a(74488),p=a(88689);let g=e=>{let t=new Map,a=Math.floor(Date.now()/1e3);return e.forEach(e=>{t.has(e.courierCompany)||t.set(e.courierCompany,{companyName:e.courierCompany,totalHandled:0,delivered:0,delayed:0});let s=t.get(e.courierCompany);s.totalHandled++,["delivered","closed"].includes(e.status)&&s.delivered++;let r=(a-e.createdAt)/3600;!["delivered","closed"].includes(e.status)&&r>48&&s.delayed++}),Array.from(t.values())};function h(){let[e,t]=(0,r.useState)([]),[a,h]=(0,r.useState)("week"),[f,y]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{y(!0);try{let e=(0,x.ki)(a),s=await (0,x.wD)(e);t(s)}catch(e){console.error("Failed to load metrics",e)}finally{y(!1)}})()},[a]);let b=(0,r.useMemo)(()=>g(e),[e]);return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsx)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Courier Reports"})}),(0,s.jsx)(p.f8,{currentFilter:a,onFilterChange:h,onExport:()=>(0,x.GS)(e),isLoading:f}),f?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,s.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Courier Volume & Delays"}),(0,s.jsx)("div",{className:"h-80",children:(0,s.jsx)(n.h,{width:"100%",height:"100%",children:(0,s.jsxs)(d.v,{data:b,margin:{top:20,right:30,left:20,bottom:5},children:[(0,s.jsx)(o.q,{strokeDasharray:"3 3",vertical:!1}),(0,s.jsx)(l.K,{dataKey:"companyName"}),(0,s.jsx)(i.B,{}),(0,s.jsx)(c.u,{}),(0,s.jsx)(u.D,{}),(0,s.jsx)(m.$,{dataKey:"totalHandled",name:"Total Volume",fill:"#6366f1",radius:[4,4,0,0]}),(0,s.jsx)(m.$,{dataKey:"delayed",name:"Delayed (>48h)",fill:"#ef4444",radius:[4,4,0,0]})]})})})]}),(0,s.jsx)("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)(p.xD,{headers:["Courier Company","Total Handled","Delivered","Significant Delays"]}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.companyName}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.totalHandled}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.delivered}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.delayed>0?(0,s.jsxs)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-bold",children:[e.delayed," Delayed"]}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})})]},e.companyName))})]})})})]})]})}},88689:function(e,t,a){"use strict";a.d(t,{OE:function(){return o},Rm:function(){return r},f8:function(){return n},xD:function(){return d}});var s=a(57437);a(2265);let r=e=>{let{title:t,value:a,icon:r,trend:n,colorClass:d,trendColor:o}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-1",children:t}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:a}),n&&(0,s.jsx)("p",{className:"text-xs mt-2 font-medium ".concat(o||"text-gray-500"),children:n})]}),(0,s.jsx)("div",{className:"p-3 rounded-lg ".concat(d," bg-opacity-10"),children:(0,s.jsx)(r,{className:"w-6 h-6 ".concat(d.replace("bg-","text-"))})})]})},n=e=>{let{currentFilter:t,onFilterChange:a,onExport:r,onSeed:n,isLoading:d}=e;return(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-4 rounded-lg border border-gray-200 mb-6 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Time Range:"}),(0,s.jsxs)("select",{value:t,onChange:e=>a(e.target.value),className:"form-select block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border",children:[(0,s.jsx)("option",{value:"today",children:"Today"}),(0,s.jsx)("option",{value:"week",children:"Last 7 Days"}),(0,s.jsx)("option",{value:"month",children:"Last 30 Days"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:n,disabled:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white \n          ".concat(d?"bg-gray-400 cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"),children:d?"Loading...":"Seed Database"}),(0,s.jsx)("button",{onClick:r,disabled:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white \n          ".concat(d?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),children:d?"Loading...":"Export CSV"})]})]})},d=e=>{let{headers:t}=e;return(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsx)("tr",{children:t.map((e,t)=>(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},t))})})},o=e=>{let{status:t}=e;return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({delivered:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800",received:"bg-blue-100 text-blue-800",assigned:"bg-yellow-100 text-yellow-800"}[t]||"bg-gray-100"),children:t.charAt(0).toUpperCase()+t.slice(1)})}},17293:function(e,t,a){"use strict";let s,r;a.d(t,{I:function(){return i},db:function(){return r}});var n=a(738),d=a(43301),o=a(5978),l=a(60062);s=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"AIzaSyBbTyHWp3qBNPVYdkauEWN9_FCu67govr0",authDomain:"abs1-96886.firebaseapp.com",projectId:"abs1-96886",storageBucket:"abs1-96886.appspot.com",messagingSenderId:"139924754132",appId:"1:139924754132:web:cc366779227133dab5f541"});let i=(0,d.v0)(s);(0,l.cF)(s);try{r=(0,o.ad)(s)}catch(e){console.error("Firestore initialization failed:",e),r=(0,o.LV)(s,{localCache:(0,o.j5)({tabManager:(0,o.n3)()})})}},74488:function(e,t,a){"use strict";a.d(t,{GS:function(){return o},ki:function(){return d},vQ:function(){return l},wD:function(){return n}});var s=a(17293),r=a(5978);let n=async e=>{let t=(0,r.hJ)(s.db,"parcels"),a=Math.floor(e.startDate.getTime()/1e3),n=Math.floor(e.endDate.getTime()/1e3),d=(0,r.IO)(t,(0,r.ar)("createdAt",">=",a),(0,r.ar)("createdAt","<=",n));try{let e=await (0,r.PL)(d),t=[];return e.forEach(e=>{t.push(e.data())}),t}catch(e){throw console.error("Error fetching parcels:",e),e}},d=e=>{let t=new Date,a=new Date;return"today"===e?a.setHours(0,0,0,0):"week"===e?a.setDate(t.getDate()-7):a.setMonth(t.getMonth()-1),{startDate:a,endDate:t}},o=e=>{let t=encodeURI("data:text/csv;charset=utf-8,"+["Parcel ID,Courier,Staff,Status,Type,Created Date,Delivered Date",...e.map(e=>{let t=new Date(1e3*e.createdAt).toLocaleString(),a="delivered"===e.status||"closed"===e.status?new Date(1e3*e.updatedAt).toLocaleString():"N/A";return[e.parcelId,e.courierCompany,e.assignedToName||e.assignedTo,e.status,e.type,'"'.concat(t,'"'),'"'.concat(a,'"')].join(",")})].join("\n")),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","parcel_report.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},l=async()=>{let e=(0,r.qs)(s.db);Object.values({"PCL-2024-1001":{parcelId:"PCL-2024-1001",type:"incoming",courierCompany:"BlueDart",assignedTo:"staff_1",assignedToName:"Alice Johnson",status:"delivered",createdAt:1709539200,updatedAt:1709625600},"PCL-2024-1002":{parcelId:"PCL-2024-1002",type:"outgoing",courierCompany:"FedEx",assignedTo:"staff_2",assignedToName:"Bob Smith",status:"assigned",createdAt:1710144e3,updatedAt:1710144e3},"PCL-2024-1003":{parcelId:"PCL-2024-1003",type:"incoming",courierCompany:"DTDC",assignedTo:"staff_3",assignedToName:"Charlie Brown",status:"received",createdAt:1710230400,updatedAt:1710230400},"PCL-2024-1004":{parcelId:"PCL-2024-1004",type:"incoming",courierCompany:"Delhivery",assignedTo:"staff_1",assignedToName:"Alice Johnson",status:"closed",createdAt:170928e4,updatedAt:1709366400},"PCL-2024-1005":{parcelId:"PCL-2024-1005",type:"outgoing",courierCompany:"BlueDart",assignedTo:"staff_2",assignedToName:"Bob Smith",status:"assigned",createdAt:1709884800,updatedAt:1709884800},"PCL-2024-1006":{parcelId:"PCL-2024-1006",type:"incoming",courierCompany:"FedEx",assignedTo:"staff_1",assignedToName:"Alice Johnson",status:"delivered",createdAt:1710316800,updatedAt:1710324e3}}).forEach(t=>{let a=(0,r.JU)(s.db,"parcels",t.parcelId);e.set(a,t)}),await e.commit(),console.log("Database seeded successfully!")}}},function(e){e.O(0,[358,139,933,546,912,971,117,744],function(){return e(e.s=17042)}),_N_E=e.O()}]);