(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[324],{36493:function(e,t,a){Promise.resolve().then(a.bind(a,78940))},78940:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var s=a(57437),r=a(2265),n=a(44794),l=a(22252),d=a(65302),o=a(91723),i=a(47625),c=a(75169),u=a(3574),g=a(20407),m=a(8147),x=a(22190),h=a(74488),f=a(88689);let p=e=>{let t=new Date;t.setHours(0,0,0,0);let a=Math.floor(t.getTime()/1e3),s=e.length,r=e.filter(e=>["received","assigned"].includes(e.status)).length,n=e.filter(e=>["delivered","closed"].includes(e.status)),l=n.length,d=n.filter(e=>e.updatedAt>=a).length,o=n.reduce((e,t)=>e+(t.updatedat-t.createdAt),0),i={totalParcels:s,pendingParcels:r,deliveredParcels:l,deliveredToday:d,avgDeliveryTimeHours:parseFloat((l>0?o/l/3600:0).toFixed(1))},c=e.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{});return{dashboardMetrics:i,statusChartData:Object.keys(c).map(e=>({name:e.charAt(0).toUpperCase()+e.slice(1),value:c[e]}))}};function b(){let[e,t]=(0,r.useState)([]),[a,b]=(0,r.useState)("week"),[y,v]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{v(!0);try{let e=(0,h.ki)(a),s=await (0,h.wD)(e);t(s)}catch(e){console.error("Failed to load metrics",e)}finally{v(!1)}})()},[a]);let j=async()=>{v(!0);try{await (0,h.vQ)(),alert("Database seeded successfully!");let e=(0,h.ki)(a),s=await (0,h.wD)(e);t(s)}catch(e){console.error("Failed to seed database",e),alert("Failed to seed database. See console for details.")}finally{v(!1)}},w=(0,r.useMemo)(()=>p(e),[e]),N=["#6366f1","#f59e0b","#10b981","#6b7280"];return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsx)("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Overview"})}),(0,s.jsx)(f.f8,{currentFilter:a,onFilterChange:b,onExport:()=>(0,h.GS)(e),onSeed:j,isLoading:y}),y?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,s.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-500",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsx)(f.Rm,{title:"Total Parcels",value:w.dashboardMetrics.totalParcels,icon:n.Z,colorClass:"bg-indigo-500"}),(0,s.jsx)(f.Rm,{title:"Pending Actions",value:w.dashboardMetrics.pendingParcels,icon:l.Z,colorClass:"bg-yellow-500",trend:"Requires attention",trendColor:"text-yellow-600"}),(0,s.jsx)(f.Rm,{title:"Delivered Today",value:w.dashboardMetrics.deliveredToday,icon:d.Z,colorClass:"bg-green-500"}),(0,s.jsx)(f.Rm,{title:"Avg Delivery Time",value:"".concat(w.dashboardMetrics.avgDeliveryTimeHours," hrs"),icon:o.Z,colorClass:"bg-purple-500"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Parcel Status Distribution"}),(0,s.jsx)("div",{className:"h-64",children:(0,s.jsx)(i.h,{width:"100%",height:"100%",children:(0,s.jsxs)(c.u,{children:[(0,s.jsx)(u.b,{data:w.statusChartData,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:w.statusChartData.map((e,t)=>(0,s.jsx)(g.b,{fill:N[t%N.length]},"cell-".concat(t)))}),(0,s.jsx)(m.u,{}),(0,s.jsx)(x.D,{})]})})})]}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"System Efficiency"}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[(0,s.jsxs)("span",{className:"block text-2xl font-bold text-green-700",children:[(w.dashboardMetrics.deliveredParcels/(w.dashboardMetrics.totalParcels||1)*100).toFixed(0),"%"]}),(0,s.jsx)("span",{className:"text-sm text-green-600",children:"Completion Rate"})]}),(0,s.jsxs)("div",{className:"p-4 bg-indigo-50 rounded-lg",children:[(0,s.jsx)("span",{className:"block text-2xl font-bold text-indigo-700",children:w.dashboardMetrics.totalParcels}),(0,s.jsx)("span",{className:"text-sm text-indigo-600",children:"Total Processed in Range"})]})]})]})})]})]})]})}},88689:function(e,t,a){"use strict";a.d(t,{OE:function(){return d},Rm:function(){return r},f8:function(){return n},xD:function(){return l}});var s=a(57437);a(2265);let r=e=>{let{title:t,value:a,icon:r,trend:n,colorClass:l,trendColor:d}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-1",children:t}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:a}),n&&(0,s.jsx)("p",{className:"text-xs mt-2 font-medium ".concat(d||"text-gray-500"),children:n})]}),(0,s.jsx)("div",{className:"p-3 rounded-lg ".concat(l," bg-opacity-10"),children:(0,s.jsx)(r,{className:"w-6 h-6 ".concat(l.replace("bg-","text-"))})})]})},n=e=>{let{currentFilter:t,onFilterChange:a,onExport:r,onSeed:n,isLoading:l}=e;return(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-4 rounded-lg border border-gray-200 mb-6 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Time Range:"}),(0,s.jsxs)("select",{value:t,onChange:e=>a(e.target.value),className:"form-select block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md border",children:[(0,s.jsx)("option",{value:"today",children:"Today"}),(0,s.jsx)("option",{value:"week",children:"Last 7 Days"}),(0,s.jsx)("option",{value:"month",children:"Last 30 Days"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:n,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white \n          ".concat(l?"bg-gray-400 cursor-not-allowed":"bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"),children:l?"Loading...":"Seed Database"}),(0,s.jsx)("button",{onClick:r,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white \n          ".concat(l?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"),children:l?"Loading...":"Export CSV"})]})]})},l=e=>{let{headers:t}=e;return(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsx)("tr",{children:t.map((e,t)=>(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e},t))})})},d=e=>{let{status:t}=e;return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({delivered:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800",received:"bg-blue-100 text-blue-800",assigned:"bg-yellow-100 text-yellow-800"}[t]||"bg-gray-100"),children:t.charAt(0).toUpperCase()+t.slice(1)})}},17293:function(e,t,a){"use strict";let s,r;a.d(t,{I:function(){return i},db:function(){return r}});var n=a(738),l=a(43301),d=a(5978),o=a(60062);s=(0,n.C6)().length?(0,n.C6)()[0]:(0,n.ZF)({apiKey:"AIzaSyBbTyHWp3qBNPVYdkauEWN9_FCu67govr0",authDomain:"abs1-96886.firebaseapp.com",projectId:"abs1-96886",storageBucket:"abs1-96886.appspot.com",messagingSenderId:"139924754132",appId:"1:139924754132:web:cc366779227133dab5f541"});let i=(0,l.v0)(s);(0,o.cF)(s);try{r=(0,d.ad)(s)}catch(e){console.error("Firestore initialization failed:",e),r=(0,d.LV)(s,{localCache:(0,d.j5)({tabManager:(0,d.n3)()})})}},74488:function(e,t,a){"use strict";a.d(t,{GS:function(){return d},ki:function(){return l},vQ:function(){return o},wD:function(){return n}});var s=a(17293),r=a(5978);let n=async e=>{let t=(0,r.hJ)(s.db,"parcels"),a=Math.floor(e.startDate.getTime()/1e3),n=Math.floor(e.endDate.getTime()/1e3),l=(0,r.IO)(t,(0,r.ar)("createdAt",">=",a),(0,r.ar)("createdAt","<=",n));try{let e=await (0,r.PL)(l),t=[];return e.forEach(e=>{t.push(e.data())}),t}catch(e){throw console.error("Error fetching parcels:",e),e}},l=e=>{let t=new Date,a=new Date;return"today"===e?a.setHours(0,0,0,0):"week"===e?a.setDate(t.getDate()-7):a.setMonth(t.getMonth()-1),{startDate:a,endDate:t}},d=e=>{let t=encodeURI("data:text/csv;charset=utf-8,"+["Parcel ID,Courier,Staff,Status,Type,Created Date,Delivered Date",...e.map(e=>{let t=new Date(1e3*e.createdAt).toLocaleString(),a="delivered"===e.status||"closed"===e.status?new Date(1e3*e.updatedAt).toLocaleString():"N/A";return[e.parcelId,e.courierCompany,e.assignedToName||e.assignedTo,e.status,e.type,'"'.concat(t,'"'),'"'.concat(a,'"')].join(",")})].join("\n")),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","parcel_report.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},o=async()=>{let e=(0,r.qs)(s.db);Object.values({"PCL-2024-1001":{parcelId:"PCL-2024-1001",type:"incoming",courierCompany:"BlueDart",assignedTo:"staff_1",assignedToName:"Alice Johnson",status:"delivered",createdAt:1709539200,updatedAt:1709625600},"PCL-2024-1002":{parcelId:"PCL-2024-1002",type:"outgoing",courierCompany:"FedEx",assignedTo:"staff_2",assignedToName:"Bob Smith",status:"assigned",createdAt:1710144e3,updatedAt:1710144e3},"PCL-2024-1003":{parcelId:"PCL-2024-1003",type:"incoming",courierCompany:"DTDC",assignedTo:"staff_3",assignedToName:"Charlie Brown",status:"received",createdAt:1710230400,updatedAt:1710230400},"PCL-2024-1004":{parcelId:"PCL-2024-1004",type:"incoming",courierCompany:"Delhivery",assignedTo:"staff_1",assignedToName:"Alice Johnson",status:"closed",createdAt:170928e4,updatedAt:1709366400},"PCL-2024-1005":{parcelId:"PCL-2024-1005",type:"outgoing",courierCompany:"BlueDart",assignedTo:"staff_2",assignedToName:"Bob Smith",status:"assigned",createdAt:1709884800,updatedAt:1709884800},"PCL-2024-1006":{parcelId:"PCL-2024-1006",type:"incoming",courierCompany:"FedEx",assignedTo:"staff_1",assignedToName:"Alice Johnson",status:"delivered",createdAt:1710316800,updatedAt:1710324e3}}).forEach(t=>{let a=(0,r.JU)(s.db,"parcels",t.parcelId);e.set(a,t)}),await e.commit(),console.log("Database seeded successfully!")}}},function(e){e.O(0,[358,139,933,546,694,971,117,744],function(){return e(e.s=36493)}),_N_E=e.O()}]);